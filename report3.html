<html>
  <head>
    <meta charset="utf-8" />
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.152.2/build/three.module.js"
        }
      }
    </script>
    <script type="module">
      import * as THREE from "three";

      // サイズを指定
      const width = 960;
      const height = 540;
      let rot = 0; // 角度

      // レンダラーを作成
      const renderer = new THREE.WebGLRenderer({
        canvas: document.querySelector("#myCanvas"),
      });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(width, height);

      // シーンを作成
      const scene = new THREE.Scene();

      // カメラを作成
      const camera = new THREE.PerspectiveCamera(45, width / height);

      // 星屑を作成します (カメラの動きをわかりやすくするため)
      Field();

      function Field() {
        //ジオメトリ
            const geom = new THREE.Geometry();
          
            //マテリアル（サイズ・頂点色彩を使うか・色）
            const material = new THREE.PointsMaterial({
                size: 4, //サイズ
                transparent: true,// 透過true
                opacity: 0.6, //透過性の数値
                vertexColors: true, //頂点色彩を使うか
                sizeAttenuation: true,//カメラの奥行きの減退
                color: 0x3EDBF0 //色
            });

          //5000個のランダムな頂点作成
        const range = 500;
        for (var i = 0; i < 5000; i++) {
            //THREE.Vector3(x,y,z)
            const particle = new THREE.Vector3(
              Math.random() * range - range / 2, 
              Math.random() * range - range / 2,
              Math.random() * range - range / 2);
              
              //頂点をジオメトリに追加
              geom.vertices.push(particle);
              
              //頂点の色を追加
              const color = new THREE.Color(0xeffffc);
              geom.colors.push(color);
          }

          snow = new THREE.Points(geom, material);
          snow.name = "particles";
          scene.add(snow);
      }

      update();

      // 毎フレーム時に実行されるループイベントです
      function update() {
        rot +=1;
        // ラジアンに変換する
        const radian = (rot * Math.PI) / 180;
        // 角度に応じてカメラの位置を設定
        camera.position.x = 1000 * Math.sin(radian);
        camera.position.z = 1000 * Math.cos(radian);
        // 原点方向を見つめる
        camera.lookAt(new THREE.Vector3(0, 0, 0));
        // レンダリング
        renderer.render(scene, camera);

        requestAnimationFrame(update);
      }
    </script>
  </head>
  <body>
    <canvas id="myCanvas"></canvas>
  </body>
</html>
